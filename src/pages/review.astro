---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllNotionPosts, mapNotionPageToSchema } from '../lib/notion/posts';

const rawPosts = await getAllNotionPosts();
const posts = rawPosts.map(mapNotionPageToSchema);
---

<BaseLayout title="Reviews - jaesok-blog">
  <section class="page-header">
    <h1>Reviews</h1>
    <p>ë…¸ì…˜ì—ì„œ ìë™ìœ¼ë¡œ ë™ê¸°í™”ëœ ë¦¬ë·° ëª©ë¡ì…ë‹ˆë‹¤.</p>
  </section>

  <div class="post-list">
    {posts.length > 0 ? (
      posts.map((post) => (
        <article class="post-item">
          <time>{post.pubDate.toLocaleDateString('ko-KR')}</time>
          <h2>{post.title}</h2>
          {post.youtube && <p class="link-hint">ğŸ“º ì˜ìƒ í¬í•¨ëœ ë¦¬ë·°</p>}
          <a href={`/review/${post.id}`} class="read-more">ë¦¬ë·° ìƒì„¸ë³´ê¸° â†’</a>
        </article>
      ))
    ) : (
      <p class="empty-msg">ì‘ì„±ëœ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤. ë…¸ì…˜ì˜ Statusë¥¼ 'Published'ë¡œ ë³€ê²½í•´ ë³´ì„¸ìš”.</p>
    )}
  </div>
</BaseLayout>

<style>
  .page-header { margin-bottom: 4rem; text-align: center; }
  .post-list { display: flex; flex-direction: column; gap: 2.5rem; }
  .post-item { border-bottom: 1px solid #f0f0f0; padding-bottom: 2rem; }
  .post-item time { color: #999; font-size: 0.9rem; }
  .post-item h2 { margin: 0.5rem 0; font-size: 1.6rem; color: #222; }
  .link-hint { font-size: 0.85rem; color: #0070f3; margin-bottom: 1rem; }
  .read-more { display: inline-block; margin-top: 0.5rem; color: #0070f3; text-decoration: none; font-weight: 600; }
</style>