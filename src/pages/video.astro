---
import { getCollection } from 'astro:content';

/**
 * 1. 영상 콘텐츠 불러오기
 * - content/video 컬렉션 (아직 없어도 에러 안 남)
 * - draft 제외
 * - 날짜 기준 최신순 정렬
 */
const videos = (await getCollection('video').catch(() => []))
  .filter(video => !video.data.draft)
  .sort((a, b) => {
    const aTime = a.data.pubDate ? a.data.pubDate.getTime() : 0;
    const bTime = b.data.pubDate ? b.data.pubDate.getTime() : 0;
    return bTime - aTime;
  });
---

<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>북영상 | 조용한 세계문학 서재</title>

    <style>
      body {
        font-family: 'serif';
        background-color: #f9f7f2;
        color: #1a1a1a;
        margin: 0;
        line-height: 1.8;
      }

      nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 50px;
        background: white;
        border-bottom: 1px solid #eee;
      }

      .logo {
        font-weight: bold;
        font-size: 1.2rem;
      }

      .menu a {
        margin: 0 15px;
        text-decoration: none;
        color: #333;
        font-weight: 500;
      }

      main {
        max-width: 820px;
        margin: 80px auto;
        padding: 0 20px;
      }

      h1 {
        font-size: 2.4rem;
        font-weight: 500;
        margin-bottom: 10px;
      }

      .subtitle {
        color: #555;
        margin-bottom: 40px;
      }

      .video-list {
        list-style: none;
        padding: 0;
      }

      .video-item {
        padding: 25px 0;
        border-bottom: 1px solid #e0e0e0;
      }

      .video-item:last-child {
        border-bottom: none;
      }

      .video-title {
        font-size: 1.3rem;
        text-decoration: none;
        color: #000;
        border-bottom: 1px solid transparent;
      }

      .video-title:hover {
        border-bottom-color: #000;
      }

      .video-date {
        display: block;
        margin-top: 8px;
        font-size: 0.85rem;
        color: #888;
      }

      footer {
        margin-top: 120px;
        padding: 50px;
        font-size: 0.9rem;
        color: #888;
        border-top: 1px solid #eee;
        text-align: center;
      }
    </style>
  </head>

  <body>
    <nav>
      <div class="logo">조용한 세계문학 서재</div>

      <div class="menu">
        <a href="/">홈</a>
        <a href="/review">북리뷰</a>
        <a href="/video">북영상</a>
      </div>
    </nav>

    <main>
      <h1>북영상</h1>
      <p class="subtitle">
        책을 읽고, 말로 풀어내는 기록
      </p>

      {videos.length === 0 ? (
        <p style="color:#999;">
          아직 등록된 영상이 없습니다.<br />
          곧 유튜브 콘텐츠가 자동으로 추가될 예정입니다.
        </p>
      ) : (
        <ul class="video-list">
          {videos.map(video => (
            <li class="video-item">
              <a
                class="video-title"
                href={video.data.youtube}
                target="_blank"
                rel="noopener noreferrer"
              >
                {video.data.title}
              </a>

              {video.data.pubDate && (
                <span class="video-date">
                  {video.data.pubDate.toLocaleDateString()}
                </span>
              )}
            </li>
          ))}
        </ul>
      )}
    </main>

    <footer>
      <p>© 2025 gedsc · 조용한 세계문학 서재</p>
      <p>읽고, 말하고, 기록하는 세계문학 아카이브</p>
    </footer>
  </body>
</html>
